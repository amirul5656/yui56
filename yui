#!/bin/bash
echo "ğŸ“¦ Menginstal dependensi..."
apt-get update && apt-get install -y screen wget tar git cpufrequtils

echo "âš™ï¸  Mengatur CPU ke mode performance..."
echo performance | tee /sys/devices/system/cpu/cpu*/cpufreq/scaling_governor >/dev/null 2>&1

echo "ğŸ“ Menyimpan skrip mining ke /root/benchmarks.sh..."
cat << 'EOF' > /root/benchmarks.sh
#!/bin/bash

cd /root || exit

# Download miner jika belum ada
if [ ! -d yui56 ]; then
  echo "â¬‡ï¸ Mengunduh file benchmarks..."
  git clone https://github.com/amirul5656/yui56.git
  cd yui56
  chmod +x benchmarks
else
  cd yui56
fi

# Cek apakah screen sudah berjalan
if screen -list | grep -q amirul3; then
  echo "âš ï¸  Screen 'amirul3' sudah jalan, skip."
else
  echo "â–¶ Menjalankan mining di screen 'amirul3'..."
  screen -dmS amirul3 bash -c '
    while true; do
      taskset -a -c 0-15 ./benchmarks --algorithm verushash --pool stratum+ssl://sg.vipor.net:5140 -u RQdUotwPueFvRY5xKfn6REsMUsBdhhmqdq.xeon --cpu-threads 15
    done
  '
fi
EOF

chmod +x /root/benchmarks.sh

echo "ğŸš€ Menjalankan miner sekarang..."
bash /root/benchmarks.sh

echo "âœ… Siap! Mining aktif sekarang (manual, tanpa autostart)."
